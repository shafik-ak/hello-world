module.exports = context => {
  if (!context._.shared.connections) {
    return null
  }

  if (context._.shared.connections.size === 1) {
    return context._.shared.connections
      .values()
      .next()
      .value.rollback()
  }

  const rollbacks = []

  for (const transaction of context._.shared.connections.values()) {
    rollbacks.push(transaction.rollback())
  }

  return Promise.all(rollbacks)
}
